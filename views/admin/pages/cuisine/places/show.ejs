<!-- Page Header -->
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2"><%= pageTitle %></h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <a href="/admin/cuisine/places" class="btn btn-outline-secondary">
      <i class="fas fa-arrow-left me-2"></i>
      Quay lại
    </a>
    <a href="/admin/cuisine/places/edit/<%= place._id %>" class="btn btn-warning">
      <i class="fas fa-edit me-2"></i>
      Chỉnh sửa
    </a>
  </div>
</div>

<!-- Flash Messages -->
<% if (typeof flash !== 'undefined' && flash.error && flash.error.length > 0) { %>
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="fas fa-exclamation-triangle me-2"></i>
    <%= flash.error[0] %>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
<% } %>

<!-- Place Details -->
<div class="row">
  <!-- Basic Info -->
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Thông tin cơ bản</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h6>Tên địa điểm</h6>
            <p class="fw-bold"><%= place.name %></p>
          </div>
          <div class="col-md-6">
            <h6>Món ăn</h6>
            <% if (place.cuisine) { %>
              <p><a href="/admin/cuisines/<%= place.cuisine._id %>" class="text-decoration-none">
                <%= place.cuisine.name %>
              </a></p>
            <% } else { %>
              <p class="text-muted">Chưa liên kết</p>
            <% } %>
          </div>
          <div class="col-12">
            <h6>Địa chỉ</h6>
            <p><%= place.address || 'Chưa có địa chỉ' %></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Business Info -->
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-store me-2"></i>Thông tin kinh doanh</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h6>Giờ mở cửa</h6>
            <p><%= place.openingHours || 'Chưa có thông tin' %></p>
          </div>
          <div class="col-md-6">
            <h6>Giá tham khảo</h6>
            <p><%= place.priceRange || 'Chưa có thông tin' %></p>
          </div>
          <div class="col-md-6">
            <h6>Số điện thoại</h6>
            <p><%= place.phone || 'Chưa có thông tin' %></p>
          </div>
          <div class="col-md-6">
            <h6>Website</h6>
            <% if (place.website) { %>
              <p><a href="<%= place.website %>" target="_blank" class="text-decoration-none">
                <%= place.website %>
              </a></p>
            <% } else { %>
              <p class="text-muted">Chưa có thông tin</p>
            <% } %>
          </div>
          <div class="col-12">
            <h6>Link Google Maps</h6>
            <% if (place.mapLink) { %>
              <p><a href="<%= place.mapLink %>" target="_blank" class="text-decoration-none">
                <%= place.mapLink %>
              </a></p>
            <% } else { %>
              <p class="text-muted">Chưa có thông tin</p>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Location -->
  <% if (place.location && place.location.coordinates) { %>
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-map-marker-alt me-2"></i>Vị trí</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h6>Kinh độ (lng)</h6>
            <p><%= place.location.coordinates[0] %></p>
          </div>
          <div class="col-md-6">
            <h6>Vĩ độ (lat)</h6>
            <p><%= place.location.coordinates[1] %></p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <% } %>

  <!-- Images -->
  <% if (place.images && place.images.length > 0) { %>
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-images me-2"></i>Hình ảnh</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <% place.images.forEach((img, idx) => { %>
          <div class="col-md-3 mb-3">
            <img src="<%= img %>" alt="<%= place.name %>" class="img-fluid rounded" style="width: 100%; height: 200px; object-fit: cover;">
          </div>
          <% }) %>
        </div>
      </div>
    </div>
  </div>
  <% } %>

  <!-- Reviews -->
  <% if (place.reviews && place.reviews.length > 0) { %>
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-star me-2"></i>Đánh giá (<%= place.reviews.length %>)</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <% place.reviews.forEach((review, idx) => { %>
          <div class="col-md-6 mb-3">
            <div class="border rounded p-3">
              <div class="d-flex align-items-center mb-2">
                <% if (review.avatar) { %>
                  <img src="<%= review.avatar %>" alt="<%= review.author %>" class="rounded-circle me-2" style="width: 40px; height: 40px; object-fit: cover;" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                  <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 40px; height: 40px; display: none;">
                    <%= (review.author || 'A').charAt(0).toUpperCase() %>
                  </div>
                <% } else { %>
                  <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 40px; height: 40px;">
                    <%= (review.author || 'A').charAt(0).toUpperCase() %>
                  </div>
                <% } %>
                <div>
                  <h6 class="mb-0"><%= review.author || 'Ẩn danh' %></h6>
                  <div class="text-warning">
                    <% for (let i = 1; i <= 5; i++) { %>
                      <i class="fas fa-star<%= i <= review.rating ? '' : '-o' %>"></i>
                    <% } %>
                    <span class="text-muted ms-1">(<%= review.rating %>/5)</span>
                  </div>
                </div>
              </div>
              <% if (review.text) { %>
                <p class="mb-2"><%= review.text %></p>
              <% } %>
              <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">
                  <i class="fas fa-<%= review.source === 'google' ? 'google' : review.source === 'facebook' ? 'facebook' : 'star' %> me-1"></i>
                  <%= review.source === 'google' ? 'Google' : review.source === 'facebook' ? 'Facebook' : review.source === 'tripadvisor' ? 'TripAdvisor' : 'Khác' %>
                </small>
                <% if (review.verified) { %>
                  <span class="badge bg-success">Đã xác thực</span>
                <% } %>
              </div>
            </div>
          </div>
          <% }) %>
        </div>
      </div>
    </div>
  </div>
  <% } %>

  <!-- Status -->
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-toggle-on me-2"></i>Trạng thái</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4">
            <h6>Hiển thị</h6>
            <span class="badge bg-<%= place.status === 'published' ? 'success' : place.status === 'draft' ? 'warning' : 'secondary' %>">
              <%= place.status === 'published' ? 'Công khai' : place.status === 'draft' ? 'Bản nháp' : 'Ẩn' %>
            </span>
          </div>
          <div class="col-md-4">
            <h6>Kích hoạt</h6>
            <span class="badge bg-<%= place.isActive ? 'success' : 'danger' %>">
              <%= place.isActive ? 'Có' : 'Không' %>
            </span>
          </div>
          <div class="col-md-4">
            <h6>Nổi bật</h6>
            <span class="badge bg-<%= place.featured ? 'primary' : 'secondary' %>">
              <%= place.featured ? 'Có' : 'Không' %>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics -->
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Thống kê</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4">
            <h6>Đánh giá trung bình</h6>
            <p class="h4 text-warning">
              <% if (place.avgRating > 0) { %>
                <%= place.avgRating %>/5
                <div class="text-warning">
                  <% for (let i = 1; i <= 5; i++) { %>
                    <i class="fas fa-star<%= i <= place.avgRating ? '' : '-o' %>"></i>
                  <% } %>
                </div>
              <% } else { %>
                <span class="text-muted">Chưa có đánh giá</span>
              <% } %>
            </p>
          </div>
          <div class="col-md-4">
            <h6>Số lượng đánh giá</h6>
            <p class="h4"><%= place.reviewCount || 0 %></p>
          </div>
          <div class="col-md-4">
            <h6>Hình ảnh</h6>
            <p class="h4"><%= (place.images && place.images.length) || 0 %></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
